---
import userIcon from '../multimedia/icons/user.png';
import emailIcon from '../multimedia/icons/email.png';
import messageIcon from '../multimedia/icons/message.png';
---


<section id="contact" class="py-20 bg-gray-950 text-white">
  <div class="max-w-3xl mx-auto px-4 fade-in-section">
    <h2 class="text-white font-black md:text-[60px] sm:text-[50px] xs:text-[40px] text-[30px] text-center fade-in-section mb-10">Contact</h2>

    <form
      action="https://formspree.io/f/mkgbqzkw"
      method="POST"
      class="bg-gray-900 p-8 rounded-xl shadow-lg space-y-6 border border-gray-700"
    >
      <div class="flex flex-col md:flex-row gap-6">
        <div class="w-full md:w-1/2">
          <div
            class="flex items-center bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 focus-within:border-cyan-400"
          >
            <img
              src={userIcon.src}
              alt="User icon"
              class="w-5 h-5 mr-3 opacity-70"
            />
            <input
              type="text"
              id="name"
              name="name"
              required
              class="w-full bg-transparent text-white focus:outline-none"
              placeholder="Your name"
            />
          </div>
        </div>

        <div class="w-full md:w-1/2">
          <div
            class="flex items-center bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 focus-within:border-cyan-400"
          >
            <img
              src={emailIcon.src}
              alt="Mail icon"
              class="w-5 h-5 mr-3 opacity-70"
            />
            <input
              type="email"
              id="email"
              name="email"
              required
              class="w-full bg-transparent text-white focus:outline-none"
              placeholder="Your email"
            />
          </div>
        </div>
      </div>

      <div>
        <div
          class="flex items-start bg-gray-800 border border-gray-600 rounded-lg px-3 py-2 focus-within:border-cyan-400"
        >
          <img
            src={messageIcon.src}
            alt="Message icon"
            class="w-5 h-5 mt-1 mr-3 opacity-70"
          />
          <textarea

            id="message"
            name="message"
            rows="5"
            required
            class="w-full bg-transparent text-white focus:outline-none resize-none"
            placeholder="Write your message here..."></textarea>
        </div>
      </div>

      <!-- ✅ reCAPTCHA V2 -->
      <div class="flex justify-center">
        <div
          class="g-recaptcha"
          data-sitekey="6Lcm_HIrAAAAAA21nBqKHQtAwoh9V6EvofH-T5mS"
        ></div>
      </div>

      <button
        type="submit"
        class="w-full bg-cyan-600 hover:bg-cyan-700 transition-all text-white py-3 rounded-lg font-semibold"
      >
        Send Message
      </button>
      <div id="form-success" class="hidden text-green-400 text-center mt-4">¡Mensaje enviado correctamente!</div>
    </form>
  </div>

</section>

<!-- ✅ reCAPTCHA script -->
<script src="https://www.google.com/recaptcha/api.js" async defer></script>
<script>
  document.addEventListener('DOMContentLoaded', () => {
    const form = document.querySelector('form[action^="https://formspree.io"]');
    const successMsg = document.getElementById('form-success');
    if (form instanceof HTMLFormElement && successMsg) {
      form.addEventListener('submit', async function (e) {
        e.preventDefault();
        const formData = new FormData(form);
        const action = form.getAttribute('action');
        if (!action) return;
        const response = await fetch(action, {
          method: 'POST',
          body: formData,
          headers: { 'Accept': 'application/json' }
        });
        if (response.ok) {
          form.reset();
          if (typeof window !== 'undefined' && typeof window.grecaptcha !== 'undefined' && window.grecaptcha.reset) window.grecaptcha.reset();
          successMsg.classList.remove('hidden');
          successMsg.textContent = '¡Mensaje enviado correctamente!';
          successMsg.classList.remove('text-red-400');
          setTimeout(() => successMsg.classList.add('hidden'), 4000);
        } else {
          successMsg.textContent = 'Hubo un error al enviar el mensaje.';
          successMsg.classList.remove('hidden');
          successMsg.classList.add('text-red-400');
          setTimeout(() => successMsg.classList.add('hidden'), 4000);
        }
      });
    }
  });
</script>
</section>


<style>
  .fade-in-section {
    opacity: 0;
    transform: translateY(20px);
    transition:
      opacity 0.6s ease-out,
      transform 0.6s ease-out;
  }

  .fade-in-section.visible {
    opacity: 1;
    transform: none;
  }
</style>